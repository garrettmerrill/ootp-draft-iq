"use strict";(()=>{var e={};e.id=841,e.ids=[841],e.modules={53524:e=>{e.exports=require("@prisma/client")},72934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},39491:e=>{e.exports=require("assert")},14300:e=>{e.exports=require("buffer")},6113:e=>{e.exports=require("crypto")},82361:e=>{e.exports=require("events")},13685:e=>{e.exports=require("http")},95687:e=>{e.exports=require("https")},63477:e=>{e.exports=require("querystring")},57310:e=>{e.exports=require("url")},73837:e=>{e.exports=require("util")},59796:e=>{e.exports=require("zlib")},62454:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>x,patchFetch:()=>w,requestAsyncStorage:()=>c,routeModule:()=>m,serverHooks:()=>f,staticGenerationAsyncStorage:()=>y});var a={};t.r(a),t.d(a,{GET:()=>p,dynamic:()=>d});var s=t(49303),n=t(88716),i=t(60670),o=t(87070),u=t(75571),l=t(95456);let d="force-dynamic";async function p(){try{let e=(await t.e(538).then(t.bind(t,13538))).default,r=await (0,u.getServerSession)(l.L);if(!r?.user)return o.NextResponse.json({error:"Unauthorized"},{status:401});let a=r.user.id,s=await e.userSettings.findUnique({where:{userId:a},select:{myTeamName:!0}});if(!s?.myTeamName)return o.NextResponse.json({picks:[],summary:{totalPicks:0,totalCommitted:0,slotDemandCount:0,unknownDemandCount:0},teamName:null,message:"No team selected"});let n=await e.draftPick.findMany({where:{userId:a,teamName:s.myTeamName},orderBy:[{round:"asc"},{pick:"asc"}]}),i=await e.player.findMany({where:{userId:a},select:{id:!0,name:!0,position:!0,demandAmount:!0,signability:!0}}),d=new Map(i.map(e=>[e.name.toLowerCase().trim(),e])),p=n.map(e=>{let r=d.get(e.playerName.toLowerCase().trim()),t=r?.demandAmount||null;return{round:e.round,pick:e.pick,overallPick:e.overallPick,playerName:e.playerName,playerId:r?.id||null,position:r?.position||null,demandAmount:t,signability:r?.signability||null,isSlotDemand:!t||"Slot"===t}}),m=0,c=0,y=0;for(let e of p)if(e.isSlotDemand)"Slot"===e.demandAmount?c++:y++;else{let r=function(e){if(!e||"Slot"===e)return 0;let r=e.replace(/,/g,"").match(/\$?([\d.]+)\s*(m|k)?/i);if(!r)return 0;let t=parseFloat(r[1]),a=r[2]?.toLowerCase();return"m"===a?t*=1e6:"k"===a&&(t*=1e3),t}(e.demandAmount);m+=r}return o.NextResponse.json({picks:p,summary:{totalPicks:p.length,totalCommitted:m,slotDemandCount:c,unknownDemandCount:y},teamName:s.myTeamName})}catch(e){return console.error("Error fetching my draft:",e),o.NextResponse.json({error:"Failed to fetch draft picks"},{status:500})}}let m=new s.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/my-draft/route",pathname:"/api/my-draft",filename:"route",bundlePath:"app/api/my-draft/route"},resolvedPagePath:"/Users/garrettmerrill/Documents/ootp-draft-iq-parent/ootp-draft-iq/src/app/api/my-draft/route.ts",nextConfigOutput:"",userland:a}),{requestAsyncStorage:c,staticGenerationAsyncStorage:y,serverHooks:f}=m,x="/api/my-draft/route";function w(){return(0,i.patchFetch)({serverHooks:f,staticGenerationAsyncStorage:y})}},95456:(e,r,t)=>{t.d(r,{L:()=>i});var a=t(53797),s=t(42023),n=t.n(s);let i={providers:[(0,a.Z)({name:"credentials",credentials:{username:{label:"Username",type:"text"},password:{label:"Password",type:"password"}},async authorize(e){let r=(await t.e(538).then(t.bind(t,13538))).default;if(!e?.username||!e?.password)throw Error("Please enter your username and password");let a=await r.user.findUnique({where:{username:e.username}});if(!a)throw Error("No user found with this username");if(!await n().compare(e.password,a.passwordHash))throw Error("Invalid password");return{id:a.id,name:a.username}}})],session:{strategy:"jwt",maxAge:2592e3},pages:{signIn:"/login",error:"/login"},callbacks:{jwt:async({token:e,user:r})=>(r&&(e.id=r.id),e),session:async({session:e,token:r})=>(e.user&&(e.user.id=r.id),e)}}}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),a=r.X(0,[948,242,790,70],()=>t(62454));module.exports=a})();